# 🌡️ MarketBrew 市场温度计

> 实时监控A股市场热度，基于东方财富真实数据

## ✨ 功能特性

### 核心功能
- 🌡️ **市场温度评分** - 0-100分实时评估市场热度
- 📊 **涨跌分析** - 实时统计全市场涨跌家数
- 💰 **资金流向** - 北向资金、主力资金流向监控
- 📈 **指数监控** - 沪深300等主要指数实时数据
- 🔄 **自动刷新** - 每2分钟自动更新数据

### 温度等级
- 🔥 **80-100分** - 过热（市场情绪高涨，注意风险）
- 📈 **60-79分** - 偏热（市场表现积极）
- 😐 **40-59分** - 正常（市场温和运行）
- 📉 **20-39分** - 偏冷（市场情绪偏弱）
- ❄️ **0-19分** - 冰冷（市场情绪低迷）

## 🚀 快速开始

### 方法一：一键启动（推荐）

1. 双击运行：`start_market_temperature.bat`
2. 等待服务启动（约5秒）
3. 浏览器自动打开市场温度计页面

### 方法二：手动启动

#### 步骤1：启动增强版服务

打开命令提示符：

```bash
cd C:\Users\86158\marketbrew
python price_service_enhanced.py
```

等待看到：
```
🚀 MarketBrew 增强版价格服务启动中...
📊 数据源: 东方财富 API (优先) + 腾讯财经 API (备用)
🌡️ 功能: 股票价格 + 市场温度计
📡 服务地址: http://localhost:5000
```

#### 步骤2：打开页面

双击打开：`market_temperature.html`

或在浏览器访问：`file:///C:/Users/86158/marketbrew/market_temperature.html`

## 📊 界面说明

### 主温度计显示
- **温度分数** - 大号显示当前市场温度（0-100分）
- **温度等级** - 文字描述当前市场状态
- **温度计可视化** - 直观显示市场热度

### 关键指标卡片
1. **北向资金**
   - 今日净流入/流出金额（亿元）
   - 正值表示流入，负值表示流出

2. **沪深300指数**
   - 实时点位
   - 今日涨跌幅

3. **市场成交额**
   - 全市场总成交额估算

4. **ETF流入**
   - 主要ETF净流入金额

### 市场情绪分析
- **上涨家数** - 红色柱状图显示上涨股票数量
- **下跌家数** - 绿色柱状图显示下跌股票数量
- **涨跌比** - 上涨家数/下跌家数的比值

## 🔧 技术架构

### 前端
- **页面**: `market_temperature.html`
- **技术**: HTML5 + CSS3 + JavaScript
- **特性**: 响应式设计、自动刷新、数据可视化

### 后端
- **服务**: `price_service_enhanced.py`
- **端口**: `5000`
- **数据源**: 东方财富 API（优先）+ 腾讯财经 API（备用）

### API端点

#### 市场温度
```
GET /api/market-temperature
```

响应示例：
```json
{
  "status": "success",
  "data": {
    "temperature_score": 65,
    "temperature_level": "偏热",
    "up_count": 2800,
    "down_count": 1500,
    "up_down_ratio": 1.87,
    "north_bound_flow": 45.67,
    "total_stocks": 4300
  },
  "timestamp": "2025-11-26T14:30:00"
}
```

#### 北向资金
```
GET /api/north-bound
```

响应示例：
```json
{
  "total": 56.78,
  "sh": 34.56,
  "sz": 22.22,
  "timestamp": "2025-11-26T14:30:00"
}
```

#### 指数数据
```
GET /api/index/000300
```

响应示例：
```json
{
  "code": "000300",
  "name": "沪深300",
  "price": 3456.78,
  "change_pct": 0.56,
  "change": 19.23,
  "open": 3440.00,
  "high": 3460.00,
  "low": 3435.00
}
```

#### 股票统计
```
POST /api/stocks
Body: { "symbols": [] }
```

响应示例：
```json
{
  "total_count": 4300,
  "up_count": 2800,
  "down_count": 1500,
  "up_down_ratio": 1.87,
  "timestamp": "2025-11-26T14:30:00"
}
```

## 💡 使用技巧

### 1. 理解温度分数

温度分数计算公式：
```
基础分数 = (上涨家数 / 总家数) × 100

调整因素：
- 北向资金 > 50亿：+5分
- 北向资金 < -50亿：-5分

最终分数范围：0-100
```

### 2. 最佳观察时间

- **9:30-11:30** - 早盘，观察开盘情绪
- **13:00-15:00** - 午盘，观察持续性
- **14:30-15:00** - 尾盘，判断收盘方向

### 3. 关键信号

**看涨信号：**
- ✅ 温度 > 60分
- ✅ 北向资金持续流入
- ✅ 涨跌比 > 2.0
- ✅ 沪深300上涨

**看跌信号：**
- ❌ 温度 < 40分
- ❌ 北向资金持续流出
- ❌ 涨跌比 < 0.8
- ❌ 沪深300下跌

### 4. 手动刷新

点击页面上的 **"🔄 刷新数据"** 按钮可手动更新数据。

系统会自动每2分钟刷新一次。

## ⚠️ 注意事项

### 数据准确性
- 数据来自东方财富官方API，与东方财富网站一致
- 市场温度分数为系统估算，仅供参考
- 投资有风险，决策需谨慎

### 服务状态
- 页面打开前必须先启动后端服务
- 如显示"连接失败"，请检查服务是否运行
- 周末和节假日市场休市，数据不更新

### 性能优化
- 系统内置缓存机制，减少API请求
- 自动刷新间隔为2分钟，避免频繁请求
- 支持手动刷新获取最新数据

## 🔍 故障排除

### 问题1：页面显示"连接失败"

**原因**: 后端服务未启动

**解决**:
1. 打开命令提示符
2. 运行: `cd C:\Users\86158\marketbrew`
3. 运行: `python price_service_enhanced.py`
4. 刷新页面

### 问题2：数据显示"--"

**原因**: 正在加载或服务器繁忙

**解决**:
1. 等待几秒后刷新页面
2. 检查网络连接
3. 查看命令行窗口是否有错误信息

### 问题3：温度分数不准确

**原因**: 数据采集可能有延迟

**解决**:
1. 点击"刷新数据"按钮
2. 对比东方财富网站数据
3. 温度分数为估算值，仅供参考

### 问题4：服务启动失败

**原因**: 依赖包未安装

**解决**:
```bash
pip install flask flask-cors requests pandas numpy
```

## 📈 高级功能

### 自定义温度计算

编辑 `price_service_enhanced.py`，修改温度计算逻辑：

```python
# 调整温度权重
temp_score = int(up_ratio * 100)  # 基础分数

# 自定义调整因素
if north_flow > 100:  # 北向资金 > 100亿
    temp_score += 10
if main_force > 50:   # 主力资金 > 50亿
    temp_score += 5
```

### 添加更多指标

在 `market_temperature.html` 中添加新的指标卡片：

```html
<div class="metric-card">
    <div class="metric-header">
        <div class="metric-icon">🏛️</div>
        <div class="metric-title">主力资金</div>
    </div>
    <div class="metric-value" id="main-force">--</div>
    <div class="metric-change">今日净流入</div>
</div>
```

## 📚 相关文档

- `README_EASTMONEY_ONLY.md` - 东方财富API配置
- `SETUP_COMPLETE.md` - 项目配置完成说明
- `price_service_enhanced.py` - 增强版服务源码
- `eastmoney_data_service.py` - 数据服务源码

## 🎯 下一步

1. ✅ 启动服务查看实时数据
2. ✅ 观察市场温度变化趋势
3. ✅ 结合其他指标做出投资决策
4. ⏭️ 自定义温度计算逻辑
5. ⏭️ 添加更多市场指标

## 📞 技术支持

### 查看日志

启动服务后，命令行窗口会显示详细日志：

```
INFO:root:✅ 获取到4500只股票数据
INFO:root:✅ 北向资金: 沪34.5亿 + 深22.2亿 = 56.7亿
INFO:root:✅ 沪深300: 3456.78 (+0.56%)
```

### 测试API

在浏览器访问：
- 服务信息: http://localhost:5000
- 健康检查: http://localhost:5000/health
- 市场温度: http://localhost:5000/api/market-temperature

---

**MarketBrew 市场温度计** 🌡️

实时掌握市场脉搏，智能投资从温度开始。

最后更新: 2025-11-26
